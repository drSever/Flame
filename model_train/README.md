# Детекция лесных пожаров. Задача бинарной классификации по фото.
## Раздел: обучение модели

- */model* - сохраненная оригинальная модель (Keras)
- */model_tflite* - сохраненная TFLite-модель
- *flame_project.ipynb* - jupyter-ноутбук, содержащий этапы загрузки датасета, его анализа, обучение модели и инференс
- *requirements.txt* - для воспроизводимости кода

### Набор данных для решения задачи: FLAME, который содержит аэроснимки с дронов для задач классификации, связанных с обнаружением огненных очагов.
![Текст ссылки](https://ieee-dataport.org/sites/default/files/styles/large/public/dataset_intro.jpg?itok=ZMenAr5c)

Лесные пожары - одно из самых смертоносных и опасных стихийных бедствий в мире. Лесные пожары сжигают миллионы лесов и подвергают опасности жизни людей и животных. Прогнозирование поведения пожара может помочь пожарным лучше управлять огнем и планировать будущие инциденты, а также снизить риск для жизни пожарных. Последние достижения в области аэрофотосъемки показывают, что они могут быть полезны при изучении лесных пожаров. Среди различных методов и технологий получения аэрофотоснимков, беспилотные летательные аппараты (БПЛА) и дроны являются полезными для сбора информации о пожаре. В данном исследовании представлен набор данных FLAME (Fire Luminosity Airborne-based Machine Learning Evaluation), полученных с помощью беспилотников во время предписанного сжигания куч в Северной Аризоне, США. 

Ссылка на датасет:    
https://ieee-dataport.org/open-access/flame-dataset-aerial-imagery-pile-burn-detection-using-drones-uavs

Опубликованная статья доступна здесь:    
https://www.sciencedirect.com/science/article/pii/S1389128621001201

Препринт статьи об этом наборе данных доступен здесь:    
https://arxiv.org/pdf/2012.14036.pdf

Более подробную информацию об этом исследовании и двух задачах машинного обучения, которые использовались, можно найти здесь:    
https://github.com/AlirezaShamsoshoara/Fire-Detection-UAV-Aerial-Image-Classification-Segmentation-UnmannedAerialVehicle

### Итоги обучения:
- Для обучение модели использовался датасет [Flame](https://ieee-dataport.org/open-access/flame-dataset-aerial-imagery-pile-burn-detection-using-drones-uavs), разделы:

    - раздел 7) `Training_Validation images for Fire_vs_NoFire image classification`
    - раздел 8) `Test images for Fire_vs_NoFire image classification Test`
- датасет представлен цветными изображениями размерностью 254х254х3
- В данных 2 класса: `0 - Fire` (пожар) и `1 - No_Fire` (нет пожара), классы несбалансированы, соотношение примерно **64/36 %**
- Модель обучалась на тренировочных данных (раздел 7), который был разделен на тренировочную и валидационную выборки в соотношении **0.8/0.2**
- В основу проекта положены результаты экспериментов [https://github.com/AlirezaShamsoshoara/Fire-Detection-UAV-Aerial-Image-Classification-Segmentation-UnmannedAerialVehicle.git](https://github.com/AlirezaShamsoshoara/Fire-Detection-UAV-Aerial-Image-Classification-Segmentation-UnmannedAerialVehicle)
    - оригинальная архитектура нейросети взята [отсюда](https://keras.io/examples/vision/image_classification_from_scratch/) (Keras, вариант сети Xception).
    - код **непосредственно** обучения нейросети примерно на 70-80% взят с указанного выше репозитория
    - остальной код ноутбука оригинальный
- Нейросеть обучена "с нуля", не использовалось дообучение уже обученной сети
- Параметры обучения:
    - **BATCH_SIZE** = 32 
    - **OPTIMIZER** = keras.optimizers.Adam(1e-3) 
    - **LOSS** = "binary_crossentropy"
    - **EPOCHS** = 40 
    - метрика **BinAccracy**
- Обучение проводилось в среде **Google Colab**, GPU **L4**
- Метрики на обучении/валидации составили, примерно **0.95/0.98**
- Инференс проводился на изображениях тестовой выборки (раздел 8 датасета), модель при обучении их не видела
- На данных момент модель правльно предсказывает на **тестовой** выборке:
    - класс 0 (Fire, пожар), примерно в **60-80%** случаях 
    - класс 1 (No_Fire, нет пожара), примерно в **70-90%** случаях
- модель сохранена в варианте модели *Keras* и *TFLite*